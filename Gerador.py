# create_baseline_notebook.py
import json
import os

def create_baseline_notebook():
    """Cria o notebook completo do Modelo Baseline em formato .ipynb"""
    
    notebook_content = {
        "cells": [
            {
                "cell_type": "markdown",
                "id": "introducao",
                "metadata": {},
                "source": [
                    "# ğŸ¯ ETAPA 3: MODELO BASELINE - REGRESSÃƒO LINEAR\n",
                    "\n",
                    "## ğŸ“‹ OBJETIVOS\n",
                    "- Criar primeiro modelo de Machine Learning\n",
                    "- Avaliar performance com mÃ©tricas robustas\n",
                    "- Identificar overfitting\n",
                    "- Analisar features mais importantes\n",
                    "- Estabelecer baseline para comparaÃ§Ã£o futura\n",
                    "\n",
                    "## ğŸ› ï¸ TÃ‰CNICAS UTILIZADAS\n",
                    "- RegressÃ£o Linear\n",
                    "- ValidaÃ§Ã£o Train/Validation/Test (60/20/20)\n",
                    "- MÃ©tricas: MSE, RMSE, MAE, RÂ²\n",
                    "- AnÃ¡lise de ResÃ­duos\n",
                    "- Feature Importance\n",
                    "\n",
                    "## ğŸ“ ARQUIVOS GERADOS\n",
                    "- `models/modelo_baseline.pkl` - Modelo treinado\n",
                    "- `analise_baseline.png` - VisualizaÃ§Ãµes do modelo"
                ]
            },
            {
                "cell_type": "markdown",
                "id": "importacoes",
                "metadata": {},
                "source": [
                    "## 1. ğŸ“š IMPORTAÃ‡Ã•ES E CONFIGURAÃ‡Ã•ES"
                ]
            },
            {
                "cell_type": "code",
                "execution_count": None,
                "id": "importacoes-codigo",
                "metadata": {},
                "outputs": [],
                "source": [
                    "# --- BIBLIOTECAS ESSENCIAIS ---\n",
                    "import pandas as pd\n",
                    "import numpy as np\n",
                    "import matplotlib.pyplot as plt\n",
                    "import seaborn as sns\n",
                    "from sklearn.model_selection import train_test_split\n",
                    "from sklearn.linear_model import LinearRegression\n",
                    "from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score\n",
                    "import joblib\n",
                    "import os\n",
                    "\n",
                    "# --- CONFIGURAÃ‡Ã•ES DE VISUALIZAÃ‡ÃƒO ---\n",
                    "sns.set_style(\"whitegrid\")\n",
                    "plt.rcParams['figure.figsize'] = (12, 6)\n",
                    "plt.rcParams['font.size'] = 12\n",
                    "\n",
                    "# Cores profissionais para os grÃ¡ficos\n",
                    "CORES = ['#2E86AB', '#A23B72', '#F18F01', '#C73E1D']\n",
                    "\n",
                    "print(\"âœ… Bibliotecas importadas e configuradas!\")"
                ]
            },
            {
                "cell_type": "markdown",
                "id": "carregar-dados",
                "metadata": {},
                "source": [
                    "## 2. ğŸ“¥ CARREGAR DADOS PRÃ‰-PROCESSADOS"
                ]
            },
            {
                "cell_type": "code",
                "execution_count": None,
                "id": "carregar-dados-codigo",
                "metadata": {},
                "outputs": [],
                "source": [
                    "# --- CARREGAR DATASET JÃ PRÃ‰-PROCESSADO ---\n",
                    "print(\"ğŸ“¥ Carregando dataset prÃ©-processado...\")\n",
                    "df = pd.read_csv(\"dataset_preprocessado.csv\")\n",
                    "\n",
                    "# VerificaÃ§Ã£o rÃ¡pida do dataset\n",
                    "print(f\"ğŸ“Š DimensÃµes do dataset: {df.shape}\")\n",
                    "print(f\"ğŸ” Amostra das primeiras linhas:\")\n",
                    "display(df.head(3))\n",
                    "\n",
                    "# InformaÃ§Ãµes sobre tipos de dados\n",
                    "print(\"\\nğŸ“‹ Tipos de dados:\")\n",
                    "print(df.dtypes.value_counts())\n",
                    "\n",
                    "print(\"\\nâœ… Dataset carregado com sucesso!\")"
                ]
            },
            {
                "cell_type": "markdown",
                "id": "preparar-dados",
                "metadata": {},
                "source": [
                    "## 3. ğŸ¯ PREPARAR DADOS PARA MODELAGEM"
                ]
            },
            {
                "cell_type": "code",
                "execution_count": None,
                "id": "preparar-dados-codigo",
                "metadata": {},
                "outputs": [],
                "source": [
                    "# --- SEPARAR FEATURES (X) E TARGET (y) ---\n",
                    "# âš ï¸ AJUSTE: Verifique se 'monthly_sales' Ã© sua coluna target!\n",
                    "target_column = 'monthly_sales'  # Altere se necessÃ¡rio\n",
                    "\n",
                    "if target_column not in df.columns:\n",
                    "    print(\"âŒ ERRO: Coluna target nÃ£o encontrada!\")\n",
                    "    print(f\"Colunas disponÃ­veis: {list(df.columns)}\")\n",
                    "else:\n",
                    "    X = df.drop(target_column, axis=1)  # Todas as colunas EXCETO target\n",
                    "    y = df[target_column]               # Apenas a coluna target\n",
                    "    \n",
                    "    print(f\"ğŸ¯ VariÃ¡vel target: {target_column}\")\n",
                    "    print(f\"ğŸ“ˆ NÃºmero de features: {X.shape[1]}\")\n",
                    "    print(f\"ğŸ“Š NÃºmero de observaÃ§Ãµes: {X.shape[0]}\")\n",
                    "    \n",
                    "    # EstatÃ­sticas da variÃ¡vel target\n",
                    "    print(f\"\\nğŸ“‹ EstatÃ­sticas da variÃ¡vel target:\")\n",
                    "    print(f\"   MÃ©dia: {y.mean():.2f}\")\n",
                    "    print(f\"   Desvio padrÃ£o: {y.std():.2f}\")\n",
                    "    print(f\"   MÃ­nimo: {y.min():.2f}\")\n",
                    "    print(f\"   MÃ¡ximo: {y.max():.2f}\")"
                ]
            },
            {
                "cell_type": "markdown",
                "id": "divisao-dados",
                "metadata": {},
                "source": [
                    "## 4. ğŸ“Š DIVISÃƒO DOS DADOS (60% TREINO / 20% VALIDAÃ‡ÃƒO / 20% TESTE)"
                ]
            },
            {
                "cell_type": "code",
                "execution_count": None,
                "id": "divisao-dados-codigo",
                "metadata": {},
                "outputs": [],
                "source": [
                    "# --- ESTRATÃ‰GIA DE DIVISÃƒO ---\n",
                    "# 1. Primeiro: Separar 20% para teste (guardado para etapa final)\n",
                    "# 2. Depois: Dividir o restante em 75% treino / 25% validaÃ§Ã£o\n",
                    "# Resultado: 60% Treino, 20% ValidaÃ§Ã£o, 20% Teste\n",
                    "\n",
                    "print(\"ğŸ“Š Iniciando divisÃ£o dos dados...\")\n",
                    "\n",
                    "# Primeira divisÃ£o: 80% temporÃ¡rio / 20% teste\n",
                    "X_temp, X_test, y_temp, y_test = train_test_split(\n",
                    "    X, y, \n",
                    "    test_size=0.2,       # 20% para teste\n",
                    "    random_state=42,     # Semente para reproducibilidade\n",
                    "    shuffle=True         # Embaralhar dados\n",
                    ")\n",
                    "\n",
                    "# Segunda divisÃ£o: 75% treino / 25% validaÃ§Ã£o do temporÃ¡rio\n",
                    "X_train, X_val, y_train, y_val = train_test_split(\n",
                    "    X_temp, y_temp,\n",
                    "    test_size=0.25,      # 25% de 80% = 20% do total\n",
                    "    random_state=42,\n",
                    "    shuffle=True\n",
                    ")\n",
                    "\n",
                    "# --- VERIFICAÃ‡ÃƒO DA DIVISÃƒO ---\n",
                    "print(\"âœ… DivisÃ£o concluÃ­da com sucesso!\")\n",
                    "print(f\"\\nğŸ“‹ DISTRIBUIÃ‡ÃƒO DOS DADOS:\")\n",
                    "print(f\"   ğŸŸ¢ Treino:      {X_train.shape[0]:>5} amostras ({X_train.shape[0]/len(X)*100:.1f}%)\")\n",
                    "print(f\"   ğŸŸ¡ ValidaÃ§Ã£o:   {X_val.shape[0]:>5} amostras ({X_val.shape[0]/len(X)*100:.1f}%)\")\n",
                    "print(f\"   ğŸ”´ Teste:       {X_test.shape[0]:>5} amostras ({X_test.shape[0]/len(X)*100:.1f}%)\")\n",
                    "print(f\"   ğŸ“Š Total:       {len(X):>5} amostras (100.0%)\")\n",
                    "\n",
                    "print(f\"\\nğŸ¯ IMPORTANTE: Dados de teste serÃ£o guardados para a etapa final!\")\n",
                    "print(\"   Usaremos apenas treino e validaÃ§Ã£o nesta etapa.\")"
                ]
            },
            {
                "cell_type": "markdown",
                "id": "treinar-modelo",
                "metadata": {},
                "source": [
                    "## 5. ğŸ¤– TREINAR MODELO DE REGRESSÃƒO LINEAR"
                ]
            },
            {
                "cell_type": "code",
                "execution_count": None,
                "id": "treinar-modelo-codigo",
                "metadata": {},
                "outputs": [],
                "source": [
                    "# --- MODELO BASELINE: REGRESSÃƒO LINEAR ---\n",
                    "print(\"ğŸ¤– Iniciando treinamento do modelo...\")\n",
                    "\n",
                    "# Criar e treinar o modelo\n",
                    "modelo_baseline = LinearRegression()\n",
                    "\n",
                    "print(\"ğŸ“¦ ParÃ¢metros do modelo:\")\n",
                    "print(f\"   Algoritmo: {modelo_baseline.__class__.__name__}\")\n",
                    "print(f\"   Fit intercept: {modelo_baseline.fit_intercept}\")\n",
                    "\n",
                    "# Treinar o modelo\n",
                    "modelo_baseline.fit(X_train, y_train)\n",
                    "\n",
                    "print(\"\\nâœ… Modelo treinado com sucesso!\")\n",
                    "print(f\"   NÃºmero de coeficientes: {len(modelo_baseline.coef_)}\")\n",
                    "print(f\"   Intercept: {modelo_baseline.intercept_:.4f}\")\n",
                    "\n",
                    "# Fazer previsÃµes\n",
                    "y_pred_train = modelo_baseline.predict(X_train)\n",
                    "y_pred_val = modelo_baseline.predict(X_val)\n",
                    "\n",
                    "print(\"\\nğŸ¯ PrevisÃµes realizadas:\")\n",
                    "print(f\"   PrevisÃµes treino:   {len(y_pred_train)}\")\n",
                    "print(f\"   PrevisÃµes validaÃ§Ã£o: {len(y_pred_val)}\")"
                ]
            },
            {
                "cell_type": "markdown",
                "id": "metricas-avaliacao",
                "metadata": {},
                "source": [
                    "## 6. ğŸ“ˆ CALCULAR E ANALISAR MÃ‰TRICAS DE PERFORMANCE"
                ]
            },
            {
                "cell_type": "code",
                "execution_count": None,
                "id": "metricas-avaliacao-codigo",
                "metadata": {},
                "outputs": [],
                "source": [
                    "# --- FUNÃ‡ÃƒO PARA CÃLCULO DAS MÃ‰TRICAS ---\n",
                    "def calcular_metricas_completas(y_real, y_pred, nome_conjunto):\n",
                    "    \"\"\"Calcula todas as mÃ©tricas de regressÃ£o\"\"\"\n",
                    "    \n",
                    "    mse = mean_squared_error(y_real, y_pred)\n",
                    "    rmse = np.sqrt(mse)\n",
                    "    mae = mean_absolute_error(y_real, y_pred)\n",
                    "    r2 = r2_score(y_real, y_pred)\n",
                    "    \n",
                    "    return {\n",
                    "        'MSE': mse,\n",
                    "        'RMSE': rmse,\n",
                    "        'MAE': mae,\n",
                    "        'RÂ²': r2\n",
                    "    }\n",
                    "\n",
                    "def interpretar_metricas(metricas, nome_conjunto):\n",
                    "    \"\"\"Exibe e interpreta as mÃ©tricas de forma amigÃ¡vel\"\"\"\n",
                    "    \n",
                    "    print(f\"\\nğŸ“Š MÃ‰TRICAS - {nome_conjunto.upper()}:\")\n",
                    "    print(\"-\" * 40)\n",
                    "    print(f\"   ğŸ“‰ MSE:  {metricas['MSE']:>10.4f}\")\n",
                    "    print(f\"   ğŸ“ RMSE: {metricas['RMSE']:>10.4f}\")\n",
                    "    print(f\"   ğŸ“ MAE:  {metricas['MAE']:>10.4f}\")\n",
                    "    print(f\"   ğŸ¯ RÂ²:   {metricas['RÂ²']:>10.4f}\")\n",
                    "    \n",
                    "    # InterpretaÃ§Ã£o do RÂ²\n",
                    "    r2 = metricas['RÂ²']\n",
                    "    if r2 > 0.7:\n",
                    "        interpretacao = \"âœ… EXCELENTE - Modelo explica bem a variÃ¢ncia\"\n",
                    "    elif r2 > 0.5:\n",
                    "        interpretacao = \"âš ï¸  BOM - Poder explicativo moderado\"\n",
                    "    elif r2 > 0.3:\n",
                    "        interpretacao = \"ğŸ”¶ RAZOÃVEL - Algum poder explicativo\"\n",
                    "    else:\n",
                    "        interpretacao = \"âŒ BAIXO - Necessita melhorias\"\n",
                    "        \n",
                    "    print(f\"\\n   ğŸ’¡ InterpretaÃ§Ã£o RÂ²: {interpretacao}\")\n",
                    "\n",
                    "# --- CALCULAR MÃ‰TRICAS PARA TREINO E VALIDAÃ‡ÃƒO ---\n",
                    "metricas_treino = calcular_metricas_completas(y_train, y_pred_train, \"treino\")\n",
                    "metricas_validacao = calcular_metricas_completas(y_val, y_pred_val, \"validaÃ§Ã£o\")\n",
                    "\n",
                    "# Exibir resultados\n",
                    "interpretar_metricas(metricas_treino, \"Conjunto de Treino\")\n",
                    "interpretar_metricas(metricas_validacao, \"Conjunto de ValidaÃ§Ã£o\")\n",
                    "\n",
                    "# --- ANÃLISE DE OVERFITTING ---\n",
                    "diferenca_r2 = abs(metricas_treino['RÂ²'] - metricas_validacao['RÂ²'])\n",
                    "\n",
                    "print(f\"\\nğŸ” ANÃLISE DE OVERFITTING:\")\n",
                    "print(\"-\" * 40)\n",
                    "print(f\"   DiferenÃ§a RÂ² (treino - validaÃ§Ã£o): {diferenca_r2:.4f}\")\n",
                    "\n",
                    "if diferenca_r2 < 0.05:\n",
                    "    print(\"   âœ… EXCELENTE - Modelo generaliza muito bem\")\n",
                    "elif diferenca_r2 < 0.10:\n",
                    "    print(\"   âš ï¸  BOM - Pequeno overfitting, aceitÃ¡vel\")\n",
                    "elif diferenca_r2 < 0.15:\n",
                    "    print(\"   ğŸ”¶ MODERADO - Overfitting presente\")\n",
                    "else:\n",
                    "    print(\"   âŒ ALTO - Overfitting significativo\")"
                ]
            },
            {
                "cell_type": "markdown",
                "id": "feature-importance",
                "metadata": {},
                "source": [
                    "## 7. ğŸ¯ ANÃLISE DAS FEATURES MAIS IMPORTANTES"
                ]
            },
            {
                "cell_type": "code",
                "execution_count": None,
                "id": "feature-importance-codigo",
                "metadata": {},
                "outputs": [],
                "source": [
                    "# --- FEATURE IMPORTANCE PARA REGRESSÃƒO LINEAR ---\n",
                    "print(\"ğŸ¯ Analisando features mais importantes...\")\n",
                    "\n",
                    "# Criar DataFrame com importÃ¢ncia das features\n",
                    "importancia_features = pd.DataFrame({\n",
                    "    'Feature': X.columns,\n",
                    "    'Coeficiente': modelo_baseline.coef_,\n",
                    "    'ImportÃ¢ncia_Absoluta': abs(modelo_baseline.coef_)\n",
                    "})\n",
                    "\n",
                    "# Ordenar por importÃ¢ncia\n",
                    "importancia_features = importancia_features.sort_values('ImportÃ¢ncia_Absoluta', ascending=False)\n",
                    "\n",
                    "print(f\"\\nğŸ“Š TOP 10 FEATURES MAIS IMPORTANTES:\")\n",
                    "print(\"-\" * 60)\n",
                    "for i, row in importancia_features.head(10).iterrows():\n",
                    "    sinal = \"â•\" if row['Coeficiente'] > 0 else \"â–\"\n",
                    "    print(f\"   {sinal} {row['Feature']:<30} | Coef: {row['Coeficiente']:>8.4f} | Impacto: {row['ImportÃ¢ncia_Absoluta']:>8.4f}\")\n",
                    "\n",
                    "# VisualizaÃ§Ã£o das top features\n",
                    "plt.figure(figsize=(10, 6))\n",
                    "top_10 = importancia_features.head(10)\n",
                    "cores = ['#2E86AB' if x > 0 else '#A23B72' for x in top_10['Coeficiente']]\n",
                    "\n",
                    "plt.barh(top_10['Feature'], top_10['ImportÃ¢ncia_Absoluta'], color=cores)\n",
                    "plt.xlabel('ImportÃ¢ncia Absoluta')\n",
                    "plt.title('Top 10 Features Mais Importantes - Modelo Baseline')\n",
                    "plt.gca().invert_yaxis()\n",
                    "plt.grid(axis='x', alpha=0.3)\n",
                    "plt.tight_layout()\n",
                    "plt.show()\n",
                    "\n",
                    "print(f\"\\nğŸ’¡ INSIGHTS DAS FEATURES:\")\n",
                    "print(f\"   â€¢ Features com coeficiente POSITIVO aumentam as vendas\")\n",
                    "print(f\"   â€¢ Features com coeficiente NEGATIVO diminuem as vendas\")\n",
                    "print(f\"   â€¢ Magnitude indica forÃ§a do impacto\")"
                ]
            },
            {
                "cell_type": "markdown",
                "id": "visualizacoes",
                "metadata": {},
                "source": [
                    "## 8. ğŸ“Š VISUALIZAÃ‡Ã•ES PROFISSIONAIS DO MODELO"
                ]
            },
            {
                "cell_type": "code",
                "execution_count": None,
                "id": "visualizacoes-codigo",
                "metadata": {},
                "outputs": [],
                "source": [
                    "# --- GRÃFICOS COMPLETOS DE ANÃLISE ---\n",
                    "print(\"ğŸ“Š Gerando visualizaÃ§Ãµes profissionais...\")\n",
                    "\n",
                    "fig, axes = plt.subplots(2, 2, figsize=(15, 12))\n",
                    "fig.suptitle('ğŸ“ˆ ANÃLISE COMPLETA - MODELO BASELINE', fontsize=16, fontweight='bold')\n",
                    "\n",
                    "# 1. PREDIÃ‡Ã•ES vs VALORES REAIS (ValidaÃ§Ã£o)\n",
                    "axes[0,0].scatter(y_val, y_pred_val, alpha=0.6, color='#2E86AB')\n",
                    "axes[0,0].plot([y_val.min(), y_val.max()], [y_val.min(), y_val.max()], '--', color='#F18F01', linewidth=2, label='Linha Perfeita')\n",
                    "axes[0,0].set_xlabel('Valores Reais')\n",
                    "axes[0,0].set_ylabel('PrediÃ§Ãµes')\n",
                    "axes[0,0].set_title('PrediÃ§Ãµes vs Valores Reais (ValidaÃ§Ã£o)')\n",
                    "axes[0,0].legend()\n",
                    "axes[0,0].grid(True, alpha=0.3)\n",
                    "\n",
                    "# 2. DISTRIBUIÃ‡ÃƒO DOS RESÃDUOS\n",
                    "residuos = y_val - y_pred_val\n",
                    "axes[0,1].hist(residuos, bins=30, alpha=0.7, color='#A23B72', edgecolor='black')\n",
                    "axes[0,1].axvline(x=0, color='red', linestyle='--', linewidth=2, label='ResÃ­duo Zero')\n",
                    "axes[0,1].set_xlabel('ResÃ­duos (Real - Predito)')\n",
                    "axes[0,1].set_ylabel('FrequÃªncia')\n",
                    "axes[0,1].set_title('DistribuiÃ§Ã£o dos ResÃ­duos')\n",
                    "axes[0,1].legend()\n",
                    "axes[0,1].grid(True, alpha=0.3)\n",
                    "\n",
                    "# 3. RESÃDUOS vs PREDIÃ‡Ã•ES\n",
                    "axes[1,0].scatter(y_pred_val, residuos, alpha=0.6, color='#C73E1D')\n",
                    "axes[1,0].axhline(y=0, color='red', linestyle='--', linewidth=2, label='Linha Zero')\n",
                    "axes[1,0].set_xlabel('PrediÃ§Ãµes')\n",
                    "axes[1,0].set_ylabel('ResÃ­duos')\n",
                    "axes[1,0].set_title('ResÃ­duos vs PrediÃ§Ãµes')\n",
                    "axes[1,0].legend()\n",
                    "axes[1,0].grid(True, alpha=0.3)\n",
                    "\n",
                    "# 4. COMPARAÃ‡ÃƒO TREINO vs VALIDAÃ‡ÃƒO\n",
                    "metricas_comparacao = pd.DataFrame({\n",
                    "    'Conjunto': ['Treino', 'ValidaÃ§Ã£o'],\n",
                    "    'RÂ²': [metricas_treino['RÂ²'], metricas_validacao['RÂ²']],\n",
                    "    'RMSE': [metricas_treino['RMSE'], metricas_validacao['RMSE']]\n",
                    "})\n",
                    "\n",
                    "x_pos = np.arange(2)\n",
                    "largura = 0.35\n",
                    "\n",
                    "axes[1,1].bar(x_pos - largura/2, metricas_comparacao['RÂ²'], largura, label='RÂ²', color='#2E86AB', alpha=0.8)\n",
                    "axes[1,1].bar(x_pos + largura/2, metricas_comparacao['RMSE'], largura, label='RMSE', color='#A23B72', alpha=0.8)\n",
                    "axes[1,1].set_xlabel('Conjunto de Dados')\n",
                    "axes[1,1].set_ylabel('Valor da MÃ©trica')\n",
                    "axes[1,1].set_title('ComparaÃ§Ã£o: Treino vs ValidaÃ§Ã£o')\n",
                    "axes[1,1].set_xticks(x_pos)\n",
                    "axes[1,1].set_xticklabels(['Treino', 'ValidaÃ§Ã£o'])\n",
                    "axes[1,1].legend()\n",
                    "axes[1,1].grid(True, alpha=0.3)\n",
                    "\n",
                    "plt.tight_layout()\n",
                    "plt.savefig('analise_modelo_baseline.png', dpi=300, bbox_inches='tight')\n",
                    "plt.show()\n",
                    "\n",
                    "print(\"âœ… VisualizaÃ§Ãµes salvas como 'analise_modelo_baseline.png'\")"
                ]
            },
            {
                "cell_type": "markdown",
                "id": "salvar-modelo",
                "metadata": {},
                "source": [
                    "## 9. ğŸ’¾ SALVAR MODELO E RESULTADOS"
                ]
            },
            {
                "cell_type": "code",
                "execution_count": None,
                "id": "salvar-modelo-codigo",
                "metadata": {},
                "outputs": [],
                "source": [
                    "# --- SALVAR MODELO TREINADO ---\n",
                    "print(\"ğŸ’¾ Salvando modelo e resultados...\")\n",
                    "\n",
                    "# Criar diretÃ³rio se nÃ£o existir\n",
                    "os.makedirs(\"models\", exist_ok=True)\n",
                    "\n",
                    "# Salvar modelo\n",
                    "joblib.dump(modelo_baseline, \"models/modelo_baseline.pkl\")\n",
                    "print(\"âœ… Modelo salvo: models/modelo_baseline.pkl\")\n",
                    "\n",
                    "# Salvar feature importance\n",
                    "importancia_features.to_csv(\"models/feature_importance_baseline.csv\", index=False)\n",
                    "print(\"âœ… Feature importance salva: models/feature_importance_baseline.csv\")\n",
                    "\n",
                    "# Salvar mÃ©tricas em dicionÃ¡rio\n",
                    "resultados_baseline = {\n",
                    "    'metricas_treino': metricas_treino,\n",
                    "    'metricas_validacao': metricas_validacao,\n",
                    "    'diferenca_r2': diferenca_r2,\n",
                    "    'top_5_features': importancia_features.head(5).to_dict(),\n",
                    "    'modelo': 'LinearRegression',\n",
                    "    'timestamp': pd.Timestamp.now().strftime('%Y-%m-%d %H:%M:%S')\n",
                    "}\n",
                    "\n",
                    "print(\"\\nğŸ“¦ RESUMO DOS ARQUIVOS GERADOS:\")\n",
                    "print(\"   âœ… models/modelo_baseline.pkl\")\n",
                    "print(\"   âœ… models/feature_importance_baseline.csv\") \n",
                    "print(\"   âœ… analise_modelo_baseline.png\")\n",
                    "print(\"   âœ… DicionÃ¡rio 'resultados_baseline' disponÃ­vel\")"
                ]
            },
            {
                "cell_type": "markdown",
                "id": "relatorio-final",
                "metadata": {},
                "source": [
                    "## 10. ğŸ“‹ RELATÃ“RIO FINAL E PRÃ“XIMOS PASSOS"
                ]
            },
            {
                "cell_type": "code",
                "execution_count": None,
                "id": "relatorio-final-codigo",
                "metadata": {},
                "outputs": [],
                "source": [
                    "# --- RELATÃ“RIO EXECUTIVO FINAL ---\n",
                    "print(\"=\" * 70)\n",
                    "print(\"ğŸ¯ RELATÃ“RIO FINAL - MODELO BASELINE\")\n",
                    "print(\"=\" * 70)\n",
                    "\n",
                    "print(f\"\\nğŸ“ˆ PERFORMANCE DO MODELO:\")\n",
                    "print(f\"   ğŸŸ¢ RÂ² Treino:     {metricas_treino['RÂ²']:.4f}\")\n",
                    "print(f\"   ğŸŸ¡ RÂ² ValidaÃ§Ã£o:  {metricas_validacao['RÂ²']:.4f}\")\n",
                    "print(f\"   ğŸ” DiferenÃ§a:     {diferenca_r2:.4f}\")\n",
                    "\n",
                    "print(f\"\\nğŸ¯ TOP 3 FEATURES MAIS INFLUENTES:\")\n",
                    "for i, row in importancia_features.head(3).iterrows():\n",
                    "    impacto = \"POSITIVO\" if row['Coeficiente'] > 0 else \"NEGATIVO\"\n",
                    "    print(f\"   {i+1}. {row['Feature']} â†’ Impacto {impacto}\")\n",
                    "\n",
                    "print(f\"\\nğŸ“Š INTERPRETAÃ‡ÃƒO DOS RESULTADOS:\")\n",
                    "if metricas_validacao['RÂ²'] > 0.7:\n",
                    "    print(\"   âœ… EXCELENTE - Modelo explica mais de 70% da variÃ¢ncia\")\n",
                    "    print(\"   ğŸ’¡ Insight: Features atuais sÃ£o muito preditivas\")\n",
                    "elif metricas_validacao['RÂ²'] > 0.5:\n",
                    "    print(\"   âš ï¸  BOM - Modelo explica 50-70% da variÃ¢ncia\")\n",
                    "    print(\"   ğŸ’¡ Insight: Base sÃ³lida para melhorias\")\n",
                    "elif metricas_validacao['RÂ²'] > 0.3:\n",
                    "    print(\"   ğŸ”¶ MODERADO - Modelo explica 30-50% da variÃ¢ncia\")\n",
                    "    print(\"   ğŸ’¡ Insight: EspaÃ§o significativo para melhorias\")\n",
                    "else:\n",
                    "    print(\"   âŒ BAIXO - Modelo explica menos de 30% da variÃ¢ncia\")\n",
                    "    print(\"   ğŸ’¡ Insight: Necessidade de feature engineering\")\n",
                    "\n",
                    "print(f\"\\nğŸš€ RECOMENDAÃ‡Ã•ES PARA PRÃ“XIMAS ETAPAS:\")\n",
                    "if metricas_validacao['RÂ²'] < 0.6:\n",
                    "    print(\"   1. ğŸ”¥ Testar algoritmos mais complexos (Random Forest, XGBoost)\")\n",
                    "    print(\"   2. ğŸ¯ Feature engineering adicional\")\n",
                    "    print(\"   3. âš™ï¸  OtimizaÃ§Ã£o de hiperparÃ¢metros\")\n",
                    "else:\n",
                    "    print(\"   1. âœ… Validar performance com dados de teste\")\n",
                    "    print(\"   2. ğŸ”§ Fine-tuning do modelo atual\")\n",
                    "    print(\"   3. ğŸš€ Preparar para deploy em produÃ§Ã£o\")\n",
                    "\n",
                    "print(f\"\\nğŸ’¡ PRÃ“XIMA ETAPA: MODELOS AVANÃ‡ADOS\")\n",
                    "print(\"   â€¢ Comparar com Random Forest, Gradient Boosting\")\n",
                    "print(\"   â€¢ Otimizar hiperparÃ¢metros\")\n",
                    "print(\"   â€¢ Selecionar melhor modelo para deploy\")\n",
                    "\n",
                    "print(\"\\n\" + \"=\" * 70)\n",
                    "print(\"ğŸ‰ ETAPA 3 CONCLUÃDA COM SUCESSO!\")\n",
                    "print(\"=\" * 70)"
                ]
            }
        ],
        "metadata": {
            "kernelspec": {
                "display_name": "Python 3",
                "language": "python",
                "name": "python3"
            },
            "language_info": {
                "codemirror_mode": {
                    "name": "ipython",
                    "version": 3
                },
                "file_extension": ".py",
                "mimetype": "text/x-python",
                "name": "python",
                "nbconvert_exporter": "python",
                "pygments_lexer": "ipython3",
                "version": "3.8.0"
            }
        },
        "nbformat": 4,
        "nbformat_minor": 4
    }
    
    # Salvar como arquivo .ipynb
    with open('03_Modelo_Baseline.ipynb', 'w', encoding='utf-8') as f:
        json.dump(notebook_content, f, indent=2, ensure_ascii=False)
    
    print("âœ… NOTEBOOK CRIADO COM SUCESSO!")
    print("ğŸ““ Arquivo: 03_Modelo_Baseline.ipynb")
    print("ğŸš€ Abra no Jupyter e execute cÃ©lula por cÃ©lula!")

if __name__ == "__main__":
    create_baseline_notebook()